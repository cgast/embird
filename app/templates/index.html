{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<div class="row">
    <div class="col">
        {% if scored_items %}
            {% for scored in scored_items %}
            <div class="news-item-compact mb-3">
                <div class="news-title">
                    <a href="/news/{{ scored.item.id }}">{{ scored.item.title }}</a>
                </div>
                <div class="news-meta text-muted small">
                    {{ scored.item.first_seen_at.strftime('%Y-%m-%d %H:%M') }} - {{ scored.item.source_url }}
                    {% if scored.top_vectors %}
                        {% set high_score_vectors = scored.top_vectors | selectattr('score', '>', 0.4) | list %}
                        {% if high_score_vectors %}
                            - <span class="preferences-inline">
                            {% for match in high_score_vectors %}
                                <span class="preference-tag">{{ match.vector.title }} ({{ "%.2f"|format(match.score) }})</span>{% if not loop.last %}, {% endif %}
                            {% endfor %}
                            </span>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
            {% endfor %}
            <div class="text-end mt-4">
                <a href="/news" class="btn btn-primary btn-sm">View All News</a>
            </div>
        {% else %}
            <p class="text-muted">No news items available from the last 24 hours. Add some URLs to crawl.</p>
        {% endif %}
    </div>
</div>

{% endblock %}
